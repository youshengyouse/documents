---
title: 工作流程
---

## 调用堆栈总结

```bash
next dev                        # pnpm dev 就执行当前项目中 node_modules/.bin/next
└── bin/next                    # 源码：packages/next/src/bin/next.ts
    └── lib/cli/next-dev        # 源码：packages/next/src/cli/next-dev.ts中nextDev(),三个参数分别为options值为:{ port: 3000, isableSourceMaps: false },portSource值为:  default,directory值为:  undefined
        └── server/next-dev-server
            ├── 初始化文件监听
            ├── 启动WebSocket（用于HMR）
            └── 初始化Webpack编译器
                ├── 构建客户端包
                │   └── 入口: webpack/bootstrap
                │       └── 加载React和ReactDOM
                │           └── 加载_app.js（如果存在）
                │               └── 加载页面组件（如/pages/index.js）
                └── 构建服务器包
                    └── 入口: server/next-server
                        ├── 设置路由处理
                        ├── 处理SSR请求
                        │   └── 调用页面组件的getServerSideProps
                        │       └── 渲染React组件为HTML
                        └── 处理API路由
                            └── 调用/api/文件中的处理函数
```
